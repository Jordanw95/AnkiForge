{% load static %}

<div class='progress-wrapper'>
  <div id='progress-bar' class='progress-bar' style="background-color: #68a9ef; width: 0%;">&nbsp;</div>
</div>
<div id="progress-bar-message">Waiting for progress to start...</div>
<script src="{% static 'celery_progress/celery_progress.js' %}"></script>
<script src="{% static 'tablestyle/vendor/jquery/jquery-3.2.1.min.js' %}"></script>
<script>
    {% comment %} FOR REDIRECT https://github.com/czue/celery-progress/issues/41 {% endcomment %}
    function processSuccess(progressBarElement, progressBarMessageElement, result) {
        // Assuming result contains the model ID
        var model_id = result
        // Build Success URL (replace 'namespace' with your own)
        var success_url = "{% url 'forge:forge_forge_decks' pk=123456789 %}".replace(/123456789/, model_id);
        // Redirect to URL
        window.location.replace(success_url)
    }
    // Progress Bar (JQuery)
    $(function () {
        var progressUrl = "{% url 'celery_progress:task_status' task_id %}";
        CeleryProgressBar.initProgressBar(progressUrl, {
            onSuccess: processSuccess,
        })
    });
</script>